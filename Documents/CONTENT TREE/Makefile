.PHONY: update publish dashboard dashboard-stop all help sync sync-pull sync-push sync-status sync-watch sync-watch-stop sync-watch-status sync-db export-dashboard search

# –û–Ω–æ–≤–ª—é—î –≤—Å—ñ 59 Hub —Ñ–∞–π–ª—ñ–≤
update:
	@echo "üîÑ –û–Ω–æ–≤–ª—é—é Hub –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é..."
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && python3 update_hubs.py
	@echo "‚úÖ Hub –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é –æ–Ω–æ–≤–ª–µ–Ω–æ"

# –ü—É–±–ª—ñ–∫—É—î –∫–æ–Ω—Ç–µ–Ω—Ç –≤ WordPress CMS
publish:
	@echo "üì§ –ü—É–±–ª—ñ–∫—É—é –∫–æ–Ω—Ç–µ–Ω—Ç –≤ CMS..."
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && python3 scripts/publish_to_cms.py
	@echo "‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ"

# –ó–∞–ø—É—Å–∫–∞—î Dashboard –Ω–∞ localhost:8080
dashboard:
	@echo "üìä –ó–∞–ø—É—Å–∫–∞—é Dashboard..."
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && ./Dashboard/start_dashboard.sh
	@echo "‚úÖ Dashboard –¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ http://localhost:8080"

# –ó—É–ø–∏–Ω—è—î Dashboard
dashboard-stop:
	@echo "üõë –ó—É–ø–∏–Ω—è—é Dashboard..."
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && ./Dashboard/stop_dashboard.sh
	@echo "‚úÖ Dashboard –∑—É–ø–∏–Ω–µ–Ω–æ"

# –û–Ω–æ–≤–ª—é—î —Ö–∞–±–∏ + –ø—É–±–ª—ñ–∫—É—î
all: update publish

# Google Drive Sync - –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π
sync:
	@echo "üîÑ –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—é –∑ Google Drive..."
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && ./sync_content.sh both

# Google Drive Sync - —Ç—ñ–ª—å–∫–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
sync-pull:
	@echo "‚¨áÔ∏è  –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é –∑–º—ñ–Ω–∏ –∫–æ–º–∞–Ω–¥–∏ –∑ Google Drive..."
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && ./sync_content.sh pull

# Google Drive Sync - —Ç—ñ–ª—å–∫–∏ –≤–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
sync-push:
	@echo "‚¨ÜÔ∏è  –í–∏–≤–∞–Ω—Ç–∞–∂—É—é –º–æ—ó –∑–º—ñ–Ω–∏ –≤ Google Drive..."
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && ./sync_content.sh push

# Google Drive Sync - –ø–µ—Ä–µ–≥–ª—è–¥ –∑–º—ñ–Ω
sync-status:
	@echo "üëÄ –ü–µ—Ä–µ–≥–ª—è–¥ –∑–º—ñ–Ω (dry run)..."
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && ./sync_content.sh status

# Real-time sync - –∑–∞–ø—É—Å—Ç–∏—Ç–∏
sync-watch:
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && ./watch_and_sync.sh start

# Real-time sync - –∑—É–ø–∏–Ω–∏—Ç–∏
sync-watch-stop:
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && ./watch_and_sync.sh stop

# Real-time sync - —Å—Ç–∞—Ç—É—Å
sync-watch-status:
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && ./watch_and_sync.sh status

# –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏ Content/ ‚Üí SQLite
sync-db:
	@echo "üóÑÔ∏è  –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—é Content/ ‚Üí SQLite..."
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && python3 scripts/db/sync.py
	@echo "‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω–∞"

# –ï–∫—Å–ø–æ—Ä—Ç SQLite ‚Üí data.json (–¥–ª—è Dashboard)
export-dashboard:
	@echo "üìä –ï–∫—Å–ø–æ—Ä—Ç—É—é –¥–∞–Ω—ñ –¥–ª—è Dashboard..."
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && python3 scripts/db/export.py
	@echo "‚úÖ data.json –æ–Ω–æ–≤–ª–µ–Ω–æ"

# –ü–æ—à—É–∫ –ø–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É
search:
	@cd "/Users/marakinpoetry/Documents/CONTENT TREE" && python3 scripts/db/search.py $(q) $(ARGS)

# –ü–æ–∫–∞–∑—É—î –≤—Å—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏
help:
	@echo ""
	@echo "üìã –î–æ—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ Content Tree:"
	@echo ""
	@echo "  make update         - –û–Ω–æ–≤–∏—Ç–∏ Hub –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é (59 —Ö–∞–±—ñ–≤)"
	@echo "  make publish        - –û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç –≤ WordPress CMS"
	@echo "  make dashboard      - –ó–∞–ø—É—Å—Ç–∏—Ç–∏ Dashboard (localhost:8080)"
	@echo "  make dashboard-stop - –ó—É–ø–∏–Ω–∏—Ç–∏ Dashboard"
	@echo "  make all            - –û–Ω–æ–≤–∏—Ç–∏ —Ö–∞–±–∏ + –æ–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏"
	@echo ""
	@echo "  make sync           - –î–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑ Google Drive"
	@echo "  make sync-pull      - –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–º—ñ–Ω–∏ –∫–æ–º–∞–Ω–¥–∏"
	@echo "  make sync-push      - –í–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –º–æ—ó –∑–º—ñ–Ω–∏"
	@echo "  make sync-status    - –ü–µ—Ä–µ–≥–ª—è–¥ –∑–º—ñ–Ω –±–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó"
	@echo ""
	@echo "  make sync-watch     - –ó–∞–ø—É—Å—Ç–∏—Ç–∏ real-time —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é"
	@echo "  make sync-watch-stop  - –ó—É–ø–∏–Ω–∏—Ç–∏ real-time —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é"
	@echo "  make sync-watch-status - –°—Ç–∞—Ç—É—Å real-time —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó"
	@echo ""
	@echo "  make sync-db        - –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏ Content/ ‚Üí SQLite"
	@echo "  make export-dashboard - –ï–∫—Å–ø–æ—Ä—Ç SQLite ‚Üí data.json"
	@echo "  make search q=\"gantt\" - –ü–æ—à—É–∫ –ø–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É"
	@echo ""
	@echo "  make help           - –ü–æ–∫–∞–∑–∞—Ç–∏ —Ü—é –¥–æ–≤—ñ–¥–∫—É"
	@echo ""
